{"version":3,"sources":["mizzao:timesync/timesync-server.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA,qE;AACA,+E;;AAEA,2C;AACA,4B;AACA,uE;AACA,iD;AACA,0E;AACA,wC;AACA,gC;;AAEA,2C;AACA,gD;;AAEA,qD;AACA,sE;AACA,0E;AACA,K;;AAEA,mC;AACA,G;AACA,E","file":"/packages/mizzao_timesync.js","sourcesContent":["// Use rawConnectHandlers so we get a response as quickly as possible\n// https://github.com/meteor/meteor/blob/devel/packages/webapp/webapp_server.js\n\nWebApp.rawConnectHandlers.use(\"/_timesync\",\n  function(req, res, next) {\n    // Never ever cache this, otherwise weird times are shown on reload\n    // http://stackoverflow.com/q/18811286/586086\n    res.setHeader(\"Cache-Control\", \"no-cache, no-store, must-revalidate\");\n    res.setHeader(\"Pragma\", \"no-cache\");\n    res.setHeader(\"Expires\", 0);\n\n    // Avoid MIME type warnings in browsers\n    res.setHeader(\"Content-Type\", \"text/plain\");\n\n    // Cordova lives in meteor.local, so it does CORS\n    if (req.headers && req.headers.origin === 'http://meteor.local') {\n      res.setHeader('Access-Control-Allow-Origin', 'http://meteor.local');\n    }\n\n    res.end(Date.now().toString());\n  }\n);\n"]}